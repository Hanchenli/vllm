INFO 09-08 15:49:13 [__init__.py:241] Automatically detected platform cuda.
[1;36m(APIServer pid=3293676)[0;0m INFO 09-08 15:49:15 [api_server.py:1885] vLLM API server version 0.1.dev9084+g9362f1f35.d20250904
[1;36m(APIServer pid=3293676)[0;0m INFO 09-08 15:49:15 [utils.py:328] non-default args: {'model_tag': 'openai/gpt-oss-20b', 'model': 'openai/gpt-oss-20b'}
[1;36m(APIServer pid=3293676)[0;0m INFO 09-08 15:49:21 [__init__.py:744] Resolved architecture: GptOssForCausalLM
[1;36m(APIServer pid=3293676)[0;0m `torch_dtype` is deprecated! Use `dtype` instead!
[1;36m(APIServer pid=3293676)[0;0m Parse safetensors files:   0%|          | 0/3 [00:00<?, ?it/s]Parse safetensors files:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:00<00:00,  3.64it/s]Parse safetensors files: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00, 10.86it/s]
[1;36m(APIServer pid=3293676)[0;0m INFO 09-08 15:49:21 [__init__.py:1773] Using max model len 131072
[1;36m(APIServer pid=3293676)[0;0m WARNING 09-08 15:49:21 [__init__.py:1218] mxfp4 quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[1;36m(APIServer pid=3293676)[0;0m INFO 09-08 15:49:22 [scheduler.py:222] Chunked prefill is enabled with max_num_batched_tokens=8192.
[1;36m(APIServer pid=3293676)[0;0m INFO 09-08 15:49:22 [config.py:274] Overriding max cuda graph capture size to 1024 for performance.
INFO 09-08 15:49:26 [__init__.py:241] Automatically detected platform cuda.
[1;36m(EngineCore_0 pid=3294091)[0;0m INFO 09-08 15:49:28 [core.py:648] Waiting for init message from front-end.
[1;36m(EngineCore_0 pid=3294091)[0;0m INFO 09-08 15:49:28 [core.py:75] Initializing a V1 LLM engine (v0.1.dev9084+g9362f1f35.d20250904) with config: model='openai/gpt-oss-20b', speculative_config=None, tokenizer='openai/gpt-oss-20b', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config={}, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=131072, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=mxfp4, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, decoding_config=DecodingConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_backend='GptOss'), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=openai/gpt-oss-20b, enable_prefix_caching=True, chunked_prefill_enabled=True, use_async_output_proc=True, pooler_config=None, compilation_config={"level":3,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":["vllm.unified_attention","vllm.unified_attention_with_output","vllm.mamba_mixer2","vllm.mamba_mixer","vllm.short_conv","vllm.linear_attention"],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"cudagraph_mode":1,"use_cudagraph":true,"cudagraph_num_of_warmups":1,"cudagraph_capture_sizes":[1024,1008,992,976,960,944,928,912,896,880,864,848,832,816,800,784,768,752,736,720,704,688,672,656,640,624,608,592,576,560,544,528,512,496,480,464,448,432,416,400,384,368,352,336,320,304,288,272,256,248,240,232,224,216,208,200,192,184,176,168,160,152,144,136,128,120,112,104,96,88,80,72,64,56,48,40,32,24,16,8,4,2,1],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"pass_config":{},"max_capture_size":1024,"local_cache_dir":null}
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712] EngineCore failed to start.
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712] Traceback (most recent call last):
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]   File "/data/lhc/vllm/vllm/v1/engine/core.py", line 703, in run_engine_core
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]   File "/data/lhc/vllm/vllm/v1/engine/core.py", line 504, in __init__
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     super().__init__(vllm_config, executor_class, log_stats,
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]   File "/data/lhc/vllm/vllm/v1/engine/core.py", line 81, in __init__
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     self.model_executor = executor_class(vllm_config)
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]   File "/data/lhc/vllm/vllm/executor/executor_base.py", line 54, in __init__
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     self._init_executor()
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]   File "/data/lhc/vllm/vllm/executor/uniproc_executor.py", line 48, in _init_executor
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     self.collective_rpc("init_device")
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]   File "/data/lhc/vllm/vllm/executor/uniproc_executor.py", line 58, in collective_rpc
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     answer = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]   File "/data/lhc/vllm/vllm/utils/__init__.py", line 3045, in run_method
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     return func(*args, **kwargs)
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]   File "/data/lhc/vllm/vllm/worker/worker_base.py", line 603, in init_device
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     self.worker.init_device()  # type: ignore
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     ^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]   File "/data/lhc/vllm/vllm/v1/worker/gpu_worker.py", line 180, in init_device
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712]     raise ValueError(
[1;36m(EngineCore_0 pid=3294091)[0;0m ERROR 09-08 15:49:29 [core.py:712] ValueError: Free memory on device (11.25/139.81 GiB) on startup is less than desired GPU memory utilization (0.9, 125.83 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[1;36m(EngineCore_0 pid=3294091)[0;0m Process EngineCore_0:
[1;36m(EngineCore_0 pid=3294091)[0;0m Traceback (most recent call last):
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/home/eecs/lihanc/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/multiprocessing/process.py", line 314, in _bootstrap
[1;36m(EngineCore_0 pid=3294091)[0;0m     self.run()
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/home/eecs/lihanc/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/multiprocessing/process.py", line 108, in run
[1;36m(EngineCore_0 pid=3294091)[0;0m     self._target(*self._args, **self._kwargs)
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/core.py", line 716, in run_engine_core
[1;36m(EngineCore_0 pid=3294091)[0;0m     raise e
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/core.py", line 703, in run_engine_core
[1;36m(EngineCore_0 pid=3294091)[0;0m     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_0 pid=3294091)[0;0m                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/core.py", line 504, in __init__
[1;36m(EngineCore_0 pid=3294091)[0;0m     super().__init__(vllm_config, executor_class, log_stats,
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/core.py", line 81, in __init__
[1;36m(EngineCore_0 pid=3294091)[0;0m     self.model_executor = executor_class(vllm_config)
[1;36m(EngineCore_0 pid=3294091)[0;0m                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/executor/executor_base.py", line 54, in __init__
[1;36m(EngineCore_0 pid=3294091)[0;0m     self._init_executor()
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/executor/uniproc_executor.py", line 48, in _init_executor
[1;36m(EngineCore_0 pid=3294091)[0;0m     self.collective_rpc("init_device")
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/executor/uniproc_executor.py", line 58, in collective_rpc
[1;36m(EngineCore_0 pid=3294091)[0;0m     answer = run_method(self.driver_worker, method, args, kwargs)
[1;36m(EngineCore_0 pid=3294091)[0;0m              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/utils/__init__.py", line 3045, in run_method
[1;36m(EngineCore_0 pid=3294091)[0;0m     return func(*args, **kwargs)
[1;36m(EngineCore_0 pid=3294091)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/worker/worker_base.py", line 603, in init_device
[1;36m(EngineCore_0 pid=3294091)[0;0m     self.worker.init_device()  # type: ignore
[1;36m(EngineCore_0 pid=3294091)[0;0m     ^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_0 pid=3294091)[0;0m   File "/data/lhc/vllm/vllm/v1/worker/gpu_worker.py", line 180, in init_device
[1;36m(EngineCore_0 pid=3294091)[0;0m     raise ValueError(
[1;36m(EngineCore_0 pid=3294091)[0;0m ValueError: Free memory on device (11.25/139.81 GiB) on startup is less than desired GPU memory utilization (0.9, 125.83 GiB). Decrease GPU memory utilization or reduce GPU memory used by other processes.
[1;36m(APIServer pid=3293676)[0;0m Traceback (most recent call last):
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/.venv/bin/vllm", line 10, in <module>
[1;36m(APIServer pid=3293676)[0;0m     sys.exit(main())
[1;36m(APIServer pid=3293676)[0;0m              ^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/entrypoints/cli/main.py", line 54, in main
[1;36m(APIServer pid=3293676)[0;0m     args.dispatch_function(args)
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/entrypoints/cli/serve.py", line 50, in cmd
[1;36m(APIServer pid=3293676)[0;0m     uvloop.run(run_server(args))
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/.venv/lib/python3.12/site-packages/uvloop/__init__.py", line 109, in run
[1;36m(APIServer pid=3293676)[0;0m     return __asyncio.run(
[1;36m(APIServer pid=3293676)[0;0m            ^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/home/eecs/lihanc/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py", line 195, in run
[1;36m(APIServer pid=3293676)[0;0m     return runner.run(main)
[1;36m(APIServer pid=3293676)[0;0m            ^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/home/eecs/lihanc/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/asyncio/runners.py", line 118, in run
[1;36m(APIServer pid=3293676)[0;0m     return self._loop.run_until_complete(task)
[1;36m(APIServer pid=3293676)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/.venv/lib/python3.12/site-packages/uvloop/__init__.py", line 61, in wrapper
[1;36m(APIServer pid=3293676)[0;0m     return await main
[1;36m(APIServer pid=3293676)[0;0m            ^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/entrypoints/openai/api_server.py", line 1930, in run_server
[1;36m(APIServer pid=3293676)[0;0m     await run_server_worker(listen_address, sock, args, **uvicorn_kwargs)
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/entrypoints/openai/api_server.py", line 1950, in run_server_worker
[1;36m(APIServer pid=3293676)[0;0m     async with build_async_engine_client(
[1;36m(APIServer pid=3293676)[0;0m                ^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/home/eecs/lihanc/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/contextlib.py", line 210, in __aenter__
[1;36m(APIServer pid=3293676)[0;0m     return await anext(self.gen)
[1;36m(APIServer pid=3293676)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/entrypoints/openai/api_server.py", line 179, in build_async_engine_client
[1;36m(APIServer pid=3293676)[0;0m     async with build_async_engine_client_from_engine_args(
[1;36m(APIServer pid=3293676)[0;0m                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/home/eecs/lihanc/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/contextlib.py", line 210, in __aenter__
[1;36m(APIServer pid=3293676)[0;0m     return await anext(self.gen)
[1;36m(APIServer pid=3293676)[0;0m            ^^^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/entrypoints/openai/api_server.py", line 221, in build_async_engine_client_from_engine_args
[1;36m(APIServer pid=3293676)[0;0m     async_llm = AsyncLLM.from_vllm_config(
[1;36m(APIServer pid=3293676)[0;0m                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/utils/__init__.py", line 1587, in inner
[1;36m(APIServer pid=3293676)[0;0m     return fn(*args, **kwargs)
[1;36m(APIServer pid=3293676)[0;0m            ^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/async_llm.py", line 198, in from_vllm_config
[1;36m(APIServer pid=3293676)[0;0m     return cls(
[1;36m(APIServer pid=3293676)[0;0m            ^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/async_llm.py", line 124, in __init__
[1;36m(APIServer pid=3293676)[0;0m     self.engine_core = EngineCoreClient.make_async_mp_client(
[1;36m(APIServer pid=3293676)[0;0m                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/core_client.py", line 102, in make_async_mp_client
[1;36m(APIServer pid=3293676)[0;0m     return AsyncMPClient(*client_args)
[1;36m(APIServer pid=3293676)[0;0m            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/core_client.py", line 767, in __init__
[1;36m(APIServer pid=3293676)[0;0m     super().__init__(
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/core_client.py", line 446, in __init__
[1;36m(APIServer pid=3293676)[0;0m     with launch_core_engines(vllm_config, executor_class,
[1;36m(APIServer pid=3293676)[0;0m          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(APIServer pid=3293676)[0;0m   File "/home/eecs/lihanc/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/lib/python3.12/contextlib.py", line 144, in __exit__
[1;36m(APIServer pid=3293676)[0;0m     next(self.gen)
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/utils.py", line 733, in launch_core_engines
[1;36m(APIServer pid=3293676)[0;0m     wait_for_engine_startup(
[1;36m(APIServer pid=3293676)[0;0m   File "/data/lhc/vllm/vllm/v1/engine/utils.py", line 786, in wait_for_engine_startup
[1;36m(APIServer pid=3293676)[0;0m     raise RuntimeError("Engine core initialization failed. "
[1;36m(APIServer pid=3293676)[0;0m RuntimeError: Engine core initialization failed. See root cause above. Failed core proc(s): {}
